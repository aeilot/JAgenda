<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥ç¨‹ä¼˜åŒ– - JAgenda</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/modern-apple.css' %}">
</head>

<body>
    <div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: var(--space-4);">
        <div class="modern-container">
            <h1 class="modern-title">JAgenda</h1>
            <h2 class="modern-section-title" style="text-align: center; margin-bottom: var(--space-8);">æ—¥ç¨‹ä¼˜åŒ–</h2>
            
            <form method="POST" enctype="multipart/form-data" id="agendaForm" action="/agenda/">
                {% csrf_token %}
                
                <div style="margin-bottom: var(--space-6);">
                    <label for="user_input" class="modern-label">è¾“å…¥ä½ çš„æ—¥ç¨‹</label>
                    <textarea 
                        id="user_input" 
                        name="user_input"
                        class="modern-textarea"
                        placeholder="è¯·è¾“å…¥æ‚¨çš„æ—¥ç¨‹å®‰æ’..."
                        style="margin-bottom: var(--space-4);"
                    >{{user_input}}</textarea>
                    <div class="modern-example">ç¤ºä¾‹: 10:00 çº¿æ€§ä»£æ•° | 12:00 æ•°å­¦åˆ†æ</div>
                </div>

                <div class="modern-file-input">
                    <input type="file" id="pdf_file" name="pdf_file" accept="application/pdf" />
                    <label for="pdf_file" class="modern-file-label">
                        ğŸ“„ æˆ–ä¸Šä¼  PDF æ—¥ç¨‹è¡¨
                        <div style="font-size: var(--font-size-xs); margin-top: var(--space-1); opacity: 0.7;">
                            æ”¯æŒ PDF æ ¼å¼æ–‡ä»¶
                        </div>
                    </label>
                </div>

                <div class="modern-btn-group">
                    <button type="submit" class="modern-btn modern-btn-primary" id="submitBtn">
                        âœ¨ è·å–ä¸ªæ€§åŒ–å»ºè®®
                    </button>
                    <a href="/" class="modern-btn modern-btn-secondary">â† è¿”å›é¦–é¡µ</a>
                </div>
            </form>

            {% if output %}
            <div class="modern-output">
                <h3>ğŸ¯ ä¸ªæ€§åŒ–å»ºè®®ç»“æœ</h3>
                {% autoescape off %}
                {{response_text}}
                {% endautoescape %}
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        const form = document.getElementById('agendaForm');
        const submitBtn = document.getElementById('submitBtn');
        const scheduleInput = document.getElementById('user_input');
        const fileInput = document.getElementById('pdf_file');
        const fileLabel = document.querySelector('.modern-file-label');

        // Add loading state to form submission
        form.addEventListener('submit', function (e) {
            const hasInput = scheduleInput.value.trim() || fileInput.files.length > 0;
            
            if (!hasInput) {
                e.preventDefault();
                alert('è¯·è¾“å…¥æ—¥ç¨‹å†…å®¹æˆ–ä¸Šä¼ PDFæ–‡ä»¶');
                return;
            }

            submitBtn.classList.add('loading');
            submitBtn.innerHTML = 'âœ¨ æ­£åœ¨ç”Ÿæˆå»ºè®®...';
            submitBtn.disabled = true;
        });

        // Update file input label
        fileInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                fileLabel.innerHTML = `ğŸ“„ å·²é€‰æ‹©: ${this.files[0].name}`;
                fileLabel.style.borderColor = 'var(--primary-blue)';
                fileLabel.style.background = 'var(--primary-blue-light)';
                fileLabel.style.color = 'var(--primary-blue)';
            } else {
                fileLabel.innerHTML = 'ğŸ“„ æˆ–ä¸Šä¼  PDF æ—¥ç¨‹è¡¨<div style="font-size: var(--font-size-xs); margin-top: var(--space-1); opacity: 0.7;">æ”¯æŒ PDF æ ¼å¼æ–‡ä»¶</div>';
                fileLabel.style.borderColor = 'var(--neutral-300)';
                fileLabel.style.background = 'var(--neutral-50)';
                fileLabel.style.color = 'var(--neutral-600)';
            }
        });
    </script>
</body>

</html>